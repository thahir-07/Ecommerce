<style>
    #main-img{
        width:  260px ;
        height: 350px ;
        border: 1px solid;
        border-radius: 10px;
    }
    .container{
        margin-top: 100px;
    }
    .img{
        width: 70px;
        height: 70px;
        margin: 2px;
        margin-left: 5px;
        border-radius: 10px;
        border: 1px solid;
    }
    .img-container{
        margin: 2px ;
        
    }
    .focus{
        border: 2px solid rgb(23, 54, 64) !important;
    }
    button{
        border: none;
        background: none;
        padding: 0;
    }
    .desc{
         height: 200px; 
         overflow: hidden;
    }
    .image-container{
        display: none;
    }
    .image-container2{
        position: fixed; 
        width: 100%;
        z-index: 10;
        background-color: rgb(255, 255, 255);
        height: 100%;
        top:0px;
        
    }
    .image-container2 img{
        width: 70%;
        height: 60%;
    }
    .down_scroll::-webkit-scrollbar{
        display:none
    }
    .btn-close{
        position: absolute;
        top:90px;
        right: 20px;
    }
    .size{
       display: flex;
       flex-direction: row;
       padding: 10px;
       justify-content: center;
       cursor: pointer;

    }
    .size-border{
        border: 2px solid rgba(208, 178, 12, 0.84) !important;
        border-radius: 5px;
    }.size-div{
        display: flex;
        flex-direction: row;
    }
</style>
<div class="container">
    <div class="row ">
        <div class=" col-3 col-lg-2 ">
            <div class="row ">       
                        <button onclick="changeImage('{{id}}','1')" onpointerover="changeImage('{{id}}','1')">
                        <img class="img focus" id="img1" src="/product-image/{{id}}.jpg" alt="">
                        </button>   
                    
            </div>
            <div class="row">
                
                    <button onclick="changeImage('{{id}}','2')" onpointerover="changeImage('{{id}}','2')">
                        <img class="img" id="img2" src="/product-image/{{id}}2.jpg" alt="">
                    </button>    
                
            </div>
            <div class="row">
               
                    <button onclick="changeImage('{{id}}','3')" onpointerover="changeImage('{{id}}','3')">
                    <img class="img " id="img3" src="/product-image/{{id}}3.jpg" alt="">
                    </button>   
                    
            </div>
            <div class="row">
               
                    <button onclick="changeImage('{{id}}','4')" onpointerover="changeImage('{{id}}','4')">
                        <img class="img " id="img4" src="/product-image/{{id}}4.jpg" alt="">
                    </button>
                 
            </div>
        
         
                 
            
        </div>
        <div class="imgContainer  col-7  col-lg-5  ">
            <img id="main-img" src="/product-image/{{id}}.jpg" alt="">
             <div class="row text-center mt-3">
                    <button class="btn button" onclick="addToCart('{{id}}',{{user.id}})"
                style="color: rgb(255, 255, 255); width:90px;margin-left:25%;">Add to cart</button></div>
                
            <!--<div class="row text-center mt-3" style="border: 1px solid;">
                   add to cart</div>-->

        </div>
        
        
        <div class="col-12  col-lg-5">
            <div class="row text-center m-1" >  
                <div class="col-12" style="border: 1px solid; padding: 10px;margin: 2px; margin-bottom: 10px; border-radius: 5px;margin-top: 10px;">
                <h3>{{product.name}}</h3>
                <p class="text-left" style="align-content: start;">Price: &#8377; {{product.price}}</p>
                <div class="bg-color" style="color: rgb(255, 255, 255);font-size: larger; width: 60px;border-radius: 5px;margin-left: auto;margin-right: auto;" >{{#if proRating}}{{#total_rating proRating}}{{this}}{{/total_rating}}{{else}}5.0{{/if}}  &#9733;</div>
                </div>
            </div>
             {{#if product.size}}
           <div class="row m-1" >
                <div class="col-12  "  style="border: 1px solid; padding: 10px;margin: 2px; border-radius: 5px;">
                <h5>Select Size</h5>
                <div class="size-div">
                {{#each product.size}}
               <div class="size" style=" border-radius: 1px;border: 1px solid grey;margin:10px;width:50px;">{{this}}</div>
               {{/each}}
                </div>
                </div>
            </div>
            {{/if}}
            <div class="row m-1">
                <div class="col-12 " style="border: 1px solid; padding: 10px;margin: 2px; border-radius: 5px;">
                    <h4>Description</h4>
                   <div id="overview"></div>
                </div>
            </div>
            <div class="row mb-3 m-1">
                 <div class="col-12 " style="border: 1px solid grey; padding: 10px;margin: 2px; border-radius: 5px;">
                    <h4>Product Details</h4>
                    <div id="features" class="desc"></div>
                    <button onclick="change()" style="color: blue;">show more</button>
                </div>
                {{#if proRating}}
                <div class="row" style="border: 1px solid grey; padding: 10px;margin: 2px; border-radius: 5px;">
                    <div class="col-8">
                    <h4 style="display: inline;">Rating & Reviews</h4> </div>
                    <div class="col-4 mb-3 "> <div class="bg-color" style="color: rgb(255, 255, 255);font-size: larger;width:fit-content;border-radius: 5px;" ><span class="m-2">{{#if proRating}}{{#total_rating proRating}}{{this}}{{/total_rating}}{{else}}5.0{{/if}} &#9733; </span></div></div>
                     <hr>
                    <div class="down_scroll" style="height: 250px;overflow-y: scroll; padding-right: 0;">
                        {{#each proRating}}
                        <div class="row">
                        <div class="col-2"><img style="width:30px; height: 30px;border-radius: 15px;display: inline;" src="/user-image/{{this.userId}}.jpg" ></div>
                        <p class="col-6" >{{this.user_name}}</p>
                        <div class="col-4 mb-3 "> <div class="bg-color" style="color: rgb(255, 255, 255);font-size: 15px;width:fit-content;border-radius: 5px;padding: 0;" ><span class="m-2">{{this.rating}}.0 &#9733; </span></div></div>
                        </div>
                        <div >{{this.review}}</div>
                        <div class="mt-2 scrolling-wrapper" id="wrapper">
                            {{#each this.images}}
                        <img style="width: 80px;height: 80px;"id="{{this}}" src="/rating-images/{{this}}.jpg" onclick="show('{{this}}')">
                       
                        {{/each}}
                       </div>

                        <hr>
                        {{/each}}
                    </div>
                    
                </div>
                {{/if}}
    </div>
            
        </div>
       
    </div>
    
</div>
<section class=" section pt-2 mb-3">
    <div class="container">
      <div class="row ">
        <h4 style="color: rgb(59, 58, 58);">Similar Products</h4>
        
        {{#each same}}
        <div class="col-6 col-md-2 product" style="">
        <div class="card-outer mb-2" style="border: 1px solid rgba(149, 142, 142, 0.329); overflow: hidden; border-radius: 10px;margin: 0;">
          <div class="card border border-shadow card-outer" >
        <a class="load" href="/detailed-view/{{this.productData._id}}" >
            <img src="/product-image/{{this.productData._id}}.jpg" class="card-img-top" style="height:12em" alt="">
            <p class="card-text">{{this.productData.name}}</p>
            <div class="card-body pt-0" style="line-height: 3px;">
              <p class="card-text">Rs.{{this.productData.price}}/-</p>
            </div>
            <div class="pt-0 description-text" style="height: 50px;">
              <p class="card-text mt-0">{{this.productData.description}}</p>
            </div>
        </a>
            <div class="mb-1">
              <div style="color: rgb(9, 128, 104);font-size:18px;width:fit-content;display: inline;padding: 0;" ><span >{{#if this.averageRating }}{{this.averageRating}}{{else}}5.0{{/if}} &#9733; </span></div>
             <div class="p-0" style="display: inline;"> <button class="btn button mb-1" onclick="addToCart('{{this.productData._id}}',{{user}})"
                style="color: rgb(255, 255, 255);padding: 3px;font-size: 13px;" >Add to cart</button></div></div>
          </div>
        </div>
      </div>
        {{/each}}

      </div>
    </div>
  </section>

  <div class="image-container active text-center" id="i_c" >
    
    <button class="btn-close" onclick="close_window()">
        <div class="cross1"></div>
        <div class="cross2"></div>
    </button>
    <img src="" id="view" alt=""  style="margin-top:200px">
  </div>
  
<script>
     var description=`{{product.description}}`
      var paragraphs = description.split('\n');
      console.log(paragraphs)
        const formattedHTML = paragraphs.map(paragraph => `<p>${paragraph}</p>`).join('');
        const overviewDiv = document.getElementById('overview');
        overviewDiv.innerHTML = formattedHTML;

     var features=`{{product.features}}`
       var para = features.split('\n');
      console.log(para)
        const formatted = para.map(paragraph => `<p>${paragraph}</p>`).join('');
        const featureDiv = document.getElementById('features');
        featureDiv.innerHTML = formatted;
</script>
<script>
   
    var focus='img1'
   function changeImage(id,img){
    console.log('onclick workin')
    var src=document.getElementById('img'+img).src
    console.log(src)
    document.getElementById('main-img').src=src
    document.getElementById(focus).classList.remove('focus')
    document.getElementById('img'+img).classList.add('focus')
    focus='img'+img;
    
    }
function change(){
    document.getElementById('features').classList.toggle('desc')
}
var show=(id)=>{
  var review_image=document.getElementById(id).src
  document.getElementById('view').src=review_image
  var c=document.getElementById('i_c')
  c.classList.replace('image-container','image-container2')
  
  
}
function close_window(){
    var c=document.getElementById('i_c')
  c.classList.replace('image-container2','image-container')
}

   var size=document.getElementsByClassName('size')
   for (let s of size ) {
    s.addEventListener('click',()=>{
       for(let i of size){
        i.classList.remove('size-border')
       }
       s.classList.add('size-border')
    })

}
</script>